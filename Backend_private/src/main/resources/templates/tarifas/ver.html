<!DOCTYPE html>
<html lang="en" xmlns:th ="http://www.thymeleaf.org">
<head th:replace="plantilla :: head">
    <title>Tarifas</title>">
</head>
<body>

    <header th:replace="plantilla :: header"></header>

    <main>
        <div class="container mt-5">
            <h1 class="text-center">Listado de <span th:text="${nombre}"></span></h1>
        </div>

        <div class="container my-5 p-5 shadow bg-body rounded-3">
            <table class="table nowrap" id="visualizationTable">
                <thead class="table">
                <tr>
                    <th scope="col" class="text-center">ID</th>
                    <th scope="col" class="text-center">Tipo Espacio</th>
                    <th scope="col" class="text-center">Precio</th>
                    <th scope="col" class="text-center">Data Inicio</th>
                    <th scope="col" class="text-center">Data Fin</th>
                    <th scope="col" class="text-center">Por Defecto</th>
                    <th scope="col" class="text-center">Modificar</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="tarifa:${tabla}">
                    <th scope="row" th:text="${tarifa.codigo}" class="py-3 text-center bg-white"></th>
                    <td th:text="${tarifa.codigoTipoEspacio}" class="py-3 text-center bg-white"></td>
                    <td th:text="${tarifa.precio}" class="py-3 text-center bg-white"></td>
                    <td th:text="${tarifa.dataInicio}" class="py-3 text-center bg-white"></td>
                    <td th:text="${tarifa.dataFin}" class="py-3 text-center bg-white"></td>
                    <td th:text="${tarifa.porDefecto}" th:id="tarifa+${tarifa.codigo}"class="py-3 text-center bg-white"></td>
                    <td>
                        <a th:href="@{/tarifas/modificar/} + ${tarifa.codigo}" th:id="modificar+${tarifa.codigo}" th:text="Modificar" th:title="${tarifa.codigo}" class="btn btn-warning"></a>
                    </td>
                </tr>
                </tbody>
            </table>


            <div class="d-flex mt-5 justify-content-between" id="botones">
                <div>
                    <a class="btn btn-primary" th:href="@{/tarifas/crear}">Nueva Tarifa</a>
                </div>
            </div>
        </div>



    </main>
    <footer th:replace="plantilla :: footer"></footer>
    <script>
        $(document).ready(function(){

            $(".btn-warning").click(function(){
                //Seleccion per sa classe que te es boto, per tant s'aplica a tots.
                var id = $(this).attr("id");
                var codigo = $(this).attr("title");
                var modificable = $(this).parent().prev().text();
                //alert(id+", "+modificable);

                if(modificable=="true"){
                    //window.href = "/tarifas/editarDefecto/"+ codigo;
                    $(this).attr("href","/tarifas/modificarDefecto/"+ codigo);
                }
                else {
                    window.href = "/tarifas/modificar/"+ codigo;
                }
            });

            var nombre = $('h1 span').text();

            crearDataTable('visualizationTable',0,0,nombre);

            var botoExcel = $('.dt-buttons button');

            $('#visualizationTable_wrapper').remove(botoExcel);
            $('#botones').append(botoExcel);

            botoExcel.removeClass('dt-button buttons-excel buttons-html5').addClass('btn btn-success');
        });
    </script>
    <script th:replace="plantilla :: script"></script>
</body>
</html>